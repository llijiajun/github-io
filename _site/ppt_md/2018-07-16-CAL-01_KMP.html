<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  
  <!-- Favicon code from realfavicongenerator.net -->
<link rel="apple-touch-icon" sizes="180x180" href="/github-io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/github-io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/github-io/favicon-16x16.png">
<link rel="manifest" href="/github-io/site.webmanifest">
<link rel="mask-icon" href="/github-io/safari-pinned-tab.svg" color="#8b51a3">
<meta name="msapplication-TileColor" content="#563d7c">
<meta name="theme-color" content="#ffffff">

  <!--jQuery-->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

  <!-- Fonts & Icons -->
  <!--link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"-->
  <!--link href='//spoqa.github.io/spoqa-han-sans/css/SpoqaHanSans-kr.css' rel='stylesheet' type='text/css'-->

  <!-- CSS -->
  <link rel="stylesheet" href="/github-io/assets/css/main.css">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>模式匹配之KMP算法 | Homepage of Jiajun Li</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="模式匹配之KMP算法" />
<meta name="author" content="冥郡" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<meta property="og:site_name" content="Homepage of Jiajun Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="模式匹配之KMP算法" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"冥郡"},"description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","headline":"模式匹配之KMP算法","url":"/github-io/ppt_md/2018-07-16-CAL-01_KMP"}</script>
<!-- End Jekyll SEO tag -->

</head>
  <!--jQuery-->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

  <body>
  <!--nav class="nav">
      <div class="nav-container">
        <a href="/github-io/">
          <h2 class="nav-title">Homepage of Jiajun Li</h2>
        </a>
        <ul>
          <li><a href="/github-io/about">About</a></li>
          <li><a href="/github-io/">Home</a></li>
        </ul>
      </div>
    </nav-->

    <div class="container">
    

<section id="header-nav">
  <header>
    <nav>
      <ul>
        
        
        <!-- others -->
        <a href="/github-io/">
          <li class="btn-nav">Home</li>
        </a>
        
          <a href="/github-io/publications.html">
            <li class="btn-nav">Publications</li>
          </a>
        
        
        
          <a href="/github-io/blog.html">
            <li class="current btn-nav">Blog</li>
          </a>
          <a href="/github-io/tags.html">
            <li class="btn-nav">Tags</li>
          </a>
        
        
      </ul>
    </nav>
  </header>
</section>
<p>#问题描述</p>

<p><strong>模式匹配:</strong>字串的定位操作通常被称为串的<strong>模式匹配</strong></p>

<p>最简单的模式匹配方式：从主串S的第pos个字符起和模式的第一个字符比较之，若相等，则继续逐个比较后续字符；否则从主串S的下一个字符起再重新和模式的字符比较之。依次类推，直至模式T中的每个字符依次和主串S中的一个连续的字符序列相等，则称<strong>匹配成功</strong>，函数值为和模式T中第一个字符相等的字符在主串中的序号，否则称<strong>匹配失败</strong>。</p>

<hr />

<h1 id="模式匹配的改进算法">模式匹配的改进算法</h1>

<p>D.E.Knuth 、V.R.Pratt 和 J.H.Morris同时发现，其算法的本质改变在于：每当一趟匹配过程中出现字符比较不等时，不需要回溯指针，而是利用已经得到的部分匹配结果将模式向右移动尽可能远的一段距离后，继续进行比较。</p>

<p>在此不对算法本身做太多阐述，网上有很多说明，仅仅是，完成我自己在理解此算法之后，写出相应的代码。</p>

<hr />

<h1 id="求next与nextval与匹配">求next与nextval与匹配</h1>

<pre><code class="language-{c}">#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
#include&lt;malloc.h&gt;
#include&lt;memory.h&gt;
#include&lt;time.h&gt;


void Next1(char *pattern, int next[]){
	int length=strlen(pattern);
	*(next)=0;
	*(next+1)=1;
	for(int i=2;i&lt;length;i++){
		int aim=i-1;
		while(pattern[i-1]!=pattern[next[aim]-1]){
			aim=next[aim]-1;
			if(aim==0)
				break;
		}
		next[i]=next[aim]+1;
		
	}
	for(int i=1;i&lt;length;i++){
		if(pattern[i]==pattern[next[i]-1])
			next[i]=next[next[i]-1];
	}

}


void NextVal(char *pattern, int next[]){
	int length=strlen(pattern);
	*(next)=0;
	*(next+1)=1;
	for(int i=2;i&lt;length;i++){
		int aim=i-1;
		while(pattern[i-1]!=pattern[next[aim]-1]){
			aim=next[aim]-1;
			if(aim==0)
				break;
		}
		next[i]=next[aim]+1;
		
	}
	for(int i=1;i&lt;length;i++){
		if(pattern[i]==pattern[next[i]-1])
			next[i]=next[next[i]-1];
	}

}



int Index_KMP(char *S,char *T,int pos){
	//利用模式串T的next函数求在主串S中第pos个字符开始匹配到的位置
	//返回-1时代表没匹配到
	int i=pos,j=0; //i是指主串的，j是指模式串的
	int *next=(int *)malloc(sizeof(int)*strlen(T));
	NextVal(T,next);//这个过程是O(m)的
	while(i&lt;strlen(S)&amp;&amp;j&lt;strlen(T)){//这个过程O(m+n)
		if(j==0||S[i]==T[j]){
			++i;++j;
		}else{
			j=next[j]-1;
		}
	}
	if(j&gt;=strlen(T))
		return i-strlen(T);
	else
		return -1;
}



int main()
{
	char *a="aaaab";
	char *b="aaaaab";
	printf("a&amp;b KMP position: %d",Index_KMP(b,a,0));
	int n=strlen(a);
	int *nex1,*nex2;
	nex1=(int *)malloc(sizeof(int)*n);
	memset(nex1,0,sizeof(nex1));
	nex2=(int *)malloc(sizeof(int)*(1+n));
	memset(nex2,0,sizeof(nex2));
	for(int k=0;k&lt;100000;k++)
		Next1(a,nex1);
	for(int i=0;i&lt;n;i++)
		printf("%d ",nex1[i]);
	printf("\n");
	for(int k=0;k&lt;100000;k++)
		NextVal(a,nex2);
	for(int i=0;i&lt;n;i++)
		printf("%d ",nex2[i]);
	printf("\n");
	
	return 0;
}

</code></pre>


<!-- Footer
<footer>
  <div class="footer">
    Copyright © 2024
    <a href=""></a>.
    Powered by Jekyll with
    <a href="https://github.com/chrjabs/Grape-Academic-Theme">Grape Academic Theme</a>.
  </div>
</footer>
 -->
    </div>

    <footer>
      <span>
        &copy; <time datetime="2024-07-19 15:57:57 +0800">2024</time> . Made by Jiajun Li.
      </span>
    </footer>
  </body>
</html>
